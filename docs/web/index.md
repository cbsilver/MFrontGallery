---
title: The MFrontGallery project
author: Thomas Helfer
date: 18/12/2021
lang: en-EN
link-citations: true
colorlinks: true
figPrefixTemplate: "$$i$$"
tblPrefixTemplate: "$$i$$"
secPrefixTemplate: "$$i$$"
eqnPrefixTemplate: "($$i$$)"
---

This page introduces the `MFrontGallery` project available at:
<https://github.com/thelfer/MFrontGallery>

This project aims at showing an example of how to set up a high quality
material knowledge management project based on
[`MFront`](https://thelfer.github.io/tfel/web/index.html), able to meet
the requirements of critical safety studies as discussed in Section
@sec:mfm:introduction:safety_critical_studies.

In particular, the project provides:

- a [`cmake`](https://cmake.org) infrastructure that can be duplicated
  in child (academic or industrial) projects. This infrastructure allows:
  - to compile `MFront` sources using all supported interfaces supported
    by `MFront`. For example, concerning behaviours, the behaviours can
    be compiled for the following solvers:
    [`Cast3M`](http://www-cast3m.cea.fr/),
    [`code_aster`](https://code-aster.org),
    [`Europlexus`](https://europlexus.jrc.ec.europa.eu/),
    `Abaqus/Standard`, `Abaqus/Explicit`, `Ansys`, `AMITEX_FFTP`,
    [`CalculiX`](http://www.calculix.de/),
    [`ZSet`](http://www.zset-software.com/), [`DIANA
    FEA`](https://dianafea.com/). Thanks to the `generic` interface,
    those behaviours are also available in all solvers using the
    [`MFrontGenericInterfaceSupport`
    projet](https://thelfer.github.io/mgis/web/index.html) (MGIS),
    including: [`OpenGeoSys`](https://www.opengeosys.org/),
    [`MFEM-MGIS`](https://thelfer.github.io/mfem-mgis/web/index.html),
    `MANTA`,
    [`mgis.fenics`](https://thelfer.github.io/mgis/web/mgis_fenics.html),
    [`MoFEM`](http://mofem.eng.gla.ac.uk/mofem/html), XPER, etc.
  - to execute unit tests based on `MTest`. Those unit tests generate
    `XML` results files conforming to the `JUnit` standard that can
    readibily be used by continuous integration plateforms such as
    [jenkins](https://www.jenkins.io/).
  - generate the documentation associated with the stored implementations.
- a documentation of best practices to handle material knowledge
  implemented using `MFront` implementations
- a set of high-quality `MFront` implementations, as described in
  Section @sec:mfm:introduction:implementations.

Section @sec:mfm:introduction:usage provides a short overview of the
usage of the project.

# Material knowledge management for safety criticial studies {#sec:mfm:introduction:safety_critical_studies}

From a general point of view, safety criticial studies are based on the
description of the evolution of the thermodynamical state of the
materials of interest. In the context of the `MFrontGallery` project,
this thermodynamical state is described at each point of space by a set
of internal state variables which can evolve with time du to various
physical phenomena (plasticity, viscoplaticity, damage, phase change,
swelling due to dessication, etc.).

The knowledge that one may have about a given material can be
categorized as follows:

- **Material properties** are defined here as functions of the current
  state of the material.
- **Behaviours** describes how a material evolves and reacts locally due
  to gradients inside the material. Here, the material reaction is
  associated with fluxes (or forces) thermodynamically conjugated with
  the gradients.
- **Point-wise models** describes the evolution of some internal state
  variables with the evolution of other state variables. Point-wise
  models may be seen as behaviours without gradients.

The `MFrontGallery` is based on the assumption that the solvers of
interest can be use shared libraries generated by the `MFront` code
generator [@Helfer2015;@cea_edf_mfront_2021].

This assumption allows to **decouple the material knowledge management
from the development (source code) of the solver**.

The `MFrontGallery` project has been developped to address various
issues related to material knowledge management for safety criticial
studies:

- **Portability**: Safety critical studies may involve several partners
  which use different solvers. From the same `MFront` source file, the
  `MFrontGallery` can generate shared libraries for all the solvers of
  interest.
- **Maintainability over decades**: Some safety critical studies can be
  used to desing buildings, plants, systems for decades. Over such
  periods of time, both the solvers and the material knowledge may
  evolve.
- **Continuous integration and unit testing**: Each implementation has
  associated unit tests with can check no-regression during the
  development of `MFront`.
- **Documentation**: the project can generate the documentation
  associated with the various implementations.



# Implementations available {#sec:mfm:introduction:implementations}

The `MFrontGallery` project contains various high-quality `MFront`
implementations.

Those implementations may originate from the `MFront` tutorials, i.e.
the [`MFront gallery`
page](https://thelfer.github.io/tfel/web/gallery.html) (hence the name
of the project).

This project is also maint to store various contributions of academic or
industrial users of `MFront` willing to share their material knowledge
and also benefit from the continuous integration process to garantee
that no regression would happen as `MFront` evolves.

# Typical usage {#sec:mfm:introduction:usage}

After downloading or cloning the sources of the `MFrontGallery` project,
a typical usage of the project is divided in four steps (common to most
`cmake` projects):

- **Configuration**, which allows to select the interfaces to be used.
- **Compilation**, which builds the shared libraries associated wit the
  selected interfaces.
- **Unit testing**, which allows to verify that no regression occured.
- **Installation**, which can deploy the build shared libraries.

> ** Cloning the `master` branch of the `MFrontGallery` project**
> 
> The `master` branch of the `MFrontGallery` project can be cloned as
> follows:
> 
> ~~~~{.bash}
> $ git clone https://github.com/thelfer/MFrontGallery
> ~~~~

## Configuration

The sources are assumed to be in the `MFrontGallery` directory. While
not strictly required, it is convienient to create a `build` directory:

~~~~{.bash}
$ mkdir build
$ cd build
~~~~

The configuration step is triggered by calling `cmake`:

~~~~{.bash}
$ cmake  ../MFrontGallery/ -DCMAKE_BUILD_TYPE=Release     \
         -Denable-generic-behaviours=ON -Denable-ansys=ON
~~~~

The interfaces are selected by a set of `cmake` flags prefixed by
`enable`. In the previous command, we only selected the `generic` and
`ansys` interfaces.

> **`TFEL` executables**
>
> By default, the configuration step assumes that the various binaries
> provided by the `TFEL` project (including `mfront`) can be found in
> the current environment. See the [installation guide](install.html)
> for details.

The complete set of available flags are described in the [installation
guide](install.html).

The outputs of the previous command shows the generated libraries and their contents:

~~~~{.bash}
-- Adding library : HeatTransferBehaviours-generic (/home/th202608/codes/MFrontGallery/master/src/build3/generic-behaviours/heattransfer/generic/src/StationaryLinearHeatTransfer-generic.cxx;/home/th202608/codes/MFrontGallery/master/src/build3/generic-behaviours/heattransfer/generic/src/StationaryLinearHeatTransfer.cxx;/home/th202608/codes/MFrontGallery/master/src/build3/generic-behaviours/heattransfer/generic/src/StationaryNonLinearHeatTransfer-generic.cxx;/home/th202608/codes/MFrontGallery/master/src/build3/generic-behaviours/heattransfer/generic/src/StationaryNonLinearHeatTransfer.cxx;/home/th202608/codes/MFrontGallery/master/src/build3/generic-behaviours/heattransfer/generic/src/TransientLinearHeatTransfer-generic.cxx;/home/th202608/codes/MFrontGallery/master/src/build3/generic-behaviours/heattransfer/generic/src/TransientLinearHeatTransfer.cxx;/home/th202608/codes/MFrontGallery/master/src/build3/generic-behaviours/heattransfer/generic/src/TransientNonLinearHeatTransfer-generic.cxx;/home/th202608/codes/MFrontGallery/master/src/build3/generic-behaviours/heattransfer/generic/src/TransientNonLinearHeatTransfer.cxx)
~~~~~

Some `MFront` files are not compatible with the selected interface. For
example, the `ansys` interface only supports small and finite strain
behaviours. Generalized behaviours are then discarded as shown by the
following ouptut:

~~~~{.bash}
-- StationaryLinearHeatTransfer has been discarded for interface ansys (unsupported behaviour type)
-- StationaryNonLinearHeatTransfer has been discarded for interface ansys (unsupported behaviour type)
-- TransientLinearHeatTransfer has been discarded for interface ansys (unsupported behaviour type)
-- TransientNonLinearHeatTransfer has been discarded for interface ansys (unsupported behaviour type)
~~~~

## Compilation

The selected libraries can be built as follows:

~~~~{.bash}
$ cmake --build . --target all
~~~~

Various targets are avaiable.

## Unit tests

Unit tests can be executed as follows:

~~~~{.bash}
$ cmake --build . --target check
~~~~

A summary of the executed tests and their status is displayed, as
follows:

~~~~{.bash}
Test project /home/th202608/codes/MFrontGallery/master/src/build3
    Start 1: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_ansys_UpWard_mtest
1/8 Test #1: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_ansys_UpWard_mtest .........   Passed    0.02 sec
    Start 2: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_ansys_DownWard_mtest
2/8 Test #2: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_ansys_DownWard_mtest .......   Passed    0.02 sec
    Start 3: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_ansys_ToNearest_mtest
3/8 Test #3: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_ansys_ToNearest_mtest ......   Passed    0.02 sec
    Start 4: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_ansys_TowardZero_mtest
4/8 Test #4: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_ansys_TowardZero_mtest .....   Passed    0.02 sec
    Start 5: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_generic_UpWard_mtest
5/8 Test #5: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_generic_UpWard_mtest .......   Passed    0.02 sec
    Start 6: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_generic_DownWard_mtest
6/8 Test #6: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_generic_DownWard_mtest .....   Passed    0.02 sec
    Start 7: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_generic_ToNearest_mtest
7/8 Test #7: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_generic_ToNearest_mtest ....   Passed    0.02 sec
    Start 8: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_generic_TowardZero_mtest
8/8 Test #8: SemiImplicitModifiedCamClay_OpenGeoSys2020_Triax_generic_TowardZero_mtest ...   Passed    0.02 sec

100% tests passed, 0 tests failed out of 8

Total Test time (real) =   0.13 sec
Built target check
~~~~

## Installation

The built shared libraries can be installed as follows:

~~~~{.bash}
$ cmake --build . --target install
~~~~

# Acknowledgements {.unnumbered}

The `MFrontGallery` project has been developped by CEA, EDF and
Framatome as part of a common effort to build a common, robust and
material knowledge management strategy to back safety critical studies
which meet the quality requirements imposed by the French Safety Authority
(ANS).

# References